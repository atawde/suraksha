<div class="tabs-container">
  <div role="tablist" aria-label="Customer info tabs" class="tabs" id="tabs">
    <button class="tab" role="tab" aria-selected="true"
            aria-controls="panel-owner" id="tab-owner"
            tabindex="0">Vehicle & Owner Info</button>
    <button class="tab" role="tab" aria-selected="false"
            aria-controls="panel-medical" id="tab-medical"
            tabindex="-1">Medical Info</button>
    <button class="tab" role="tab" aria-selected="false"
            aria-controls="panel-driver" id="tab-driver"
            tabindex="-1">Driver Info</button>
    <button class="tab" role="tab" aria-selected="false"
            aria-controls="panel-document" id="tab-document"
            tabindex="-1">Document Locker</button>
  </div>

  <div class="tab-content tab-panel">
    <section id="panel-owner" role="tabpanel"
             aria-labelledby="tab-owner" class="active">
      <h3>Vehicle & Owner Info</h3>
      <p><strong>Name:</strong> {{ customer.name }}</p>
      <p><strong>Email:</strong> {{ customer.email }}</p>
      <p><strong>Phone:</strong> {{ customer.phone }}</p>
    </section>

    <section id="panel-medical" role="tabpanel"
             aria-labelledby="tab-medical" hidden>
      <h3>Medical Info</h3>

      {% for vehicle in customer.vehicles %}
        <p><strong>Make/Model:</strong> {{ vehicle.make }} {{ vehicle.model }}</p>
        <p><strong>Registration:</strong> {{ vehicle.reg }}</p>
        <p><strong>Year:</strong> {{ vehicle.year }}</p>
        <hr>
      {% else %}
        <p>No vehicle info available.</p>
      {% endfor %}
    </section>

    <section id="panel-driver" role="tabpanel"
             aria-labelledby="tab-other" hidden>
      <h3>Driver Info</h3>
      <p>{{ customer.notes or "No additional notes." }}</p>
    </section>

    <section id="panel-document" role="tabpanel"
             aria-labelledby="tab-other" hidden>
      <h3>Document Locker</h3>
      <p>{{ customer.notes or "No additional notes." }}</p>
    </section>

  </div>
</div>

<script>
  // same tab-switching JS
  (function(){
    const tabsEl = document.getElementById('tabs');
    if (!tabsEl) return;
    const tabs = Array.from(tabsEl.querySelectorAll('[role="tab"]'));
    const panels = tabs.map(t => document.getElementById(t.getAttribute('aria-controls')));

    function activateTab(newTab){
      tabs.forEach(t => { t.setAttribute('aria-selected','false'); t.setAttribute('tabindex','-1'); });
      panels.forEach(p => { p.hidden = true; p.classList.remove('active'); });

      newTab.setAttribute('aria-selected','true');
      newTab.setAttribute('tabindex','0');
      const panel = document.getElementById(newTab.getAttribute('aria-controls'));
      panel.hidden = false;
      panel.classList.add('active');
      newTab.focus();
    }

    tabs.forEach(t => t.addEventListener('click', () => activateTab(t)));
    tabs.forEach((t, idx) => {
      t.addEventListener('keydown', (e) => {
        const key = e.key;
        let newIndex = null;
        if (key === 'ArrowRight' || key === 'ArrowDown') newIndex = (idx + 1) % tabs.length;
        else if (key === 'ArrowLeft' || key === 'ArrowUp') newIndex = (idx - 1 + tabs.length) % tabs.length;
        else if (key === 'Home') newIndex = 0;
        else if (key === 'End') newIndex = tabs.length - 1;
        if (newIndex !== null){ e.preventDefault(); activateTab(tabs[newIndex]); }
      });
    });
  })();
</script>
